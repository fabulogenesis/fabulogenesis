<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>G√©n√©rateur de qu√™te</title>
<script>
let data = {}; // objet global pour stocker les donn√©es

// Liste des fichiers JSON et la cl√© qu'ils repr√©sentent
const jsonFiles = {
  "lieu": "data/lieu_sauvage.json",
  "description_lieu": "data/description_lieu.json",
  "theme_fr": "data/theme_fr.json",
  "personnage": "data/personnage.json",
  "personnalite": "data/personnalite.json",
  "objectif": "data/objectif.json",
  "action_fr": "data/action_fr.json"
};

// Charger tous les fichiers JSON
async function loadData() {
  const promises = Object.entries(jsonFiles).map(async ([key, file]) => {
    const response = await fetch(file + "?t=" + Date.now());
    data[key] = await response.json();
  });

  await Promise.all(promises);
  console.log("Toutes les donn√©es sont charg√©es:", data);
}

// Choisir un √©l√©ment au hasard
function pickRandom(list) {
  return list[Math.floor(Math.random() * list.length)];
}

// G√©n√©rer le texte
function generateStory() {
  if (Object.keys(data).length === 0) {
    alert("Les donn√©es ne sont pas encore charg√©es !");
    return;
  }

  const lieu = pickRandom(data.lieu);
  const personnage = pickRandom(data.personnage);
  const personnalite = pickRandom(data.personnalite);
  const theme_fr = pickRandom(data.theme_fr);
  const objectif = pickRandom(data.objectif);
  const description_lieu = pickRandom(data.description_lieu);
  const action_fr = pickRandom(data.action_fr);

  const texte = `Cette histoire commence ici : <b>${lieu}</b> - <b>${description_lieu}</b>.
  Son th√®me est : <b>${theme_fr}</b>. L'action en cours ou g√©n√©rale : <b>${action_fr}</b>.
  Le H√©ros est en compagnie de <b>${personnage}</b>, dont la personnalit√© est <b>${personnalite}</b> et l'objectif est <b>${objectif}</b>.`;

  document.getElementById("output").innerHTML = texte;
}

// Charger les donn√©es au chargement de la page
window.onload = loadData;
</script>
<style>
body {
  font-family: Arial, sans-serif;
  margin: 30px;
  background: #f7f7f7;
}
#container {
  display: flex;
  gap: 20px;
}
button {
  padding: 10px 20px;
  font-size: 16px;
  border-radius: 8px;
  border: none;
  background-color: #0077cc;
  color: white;
  cursor: pointer;
}
button:hover {
  background-color: #005fa3;
}
#output {
  flex: 1;
  padding: 15px;
  background: white;
  border-radius: 8px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
  line-height: 1.6;
}
</style>
</head>
<body>
<h1>üé≤ G√©n√©rateur d'amorce</h1>
<div id="container">
  <button onclick="generateStory()">G√©n√©rer</button>
  <div id="output">Cliquez sur "G√©n√©rer" pour obtenir une amorce.</div>
</div>
</body>
</html>
